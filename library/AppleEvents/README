APPLEEVENT SUITES DOCUMENTATIONby Terje Norderhaug <terje@in-progress.com>October 13 - 1999 The AE Suites module makes MCL scriptable and recordable. The module provides a basis and framework for building scriptable applications with MCL. It implements support for the classes and events in the standard appleevent suites, and covers means to resolve object references to allow sophisticated scripts.Apple's Script Editor can be used to do the scripts in the examples below. It is found in the AppleScript folder of the MacOS. You might have to install it from the MacOS distribution if you don't have it on your system.Adding a DictionaryThe first step in making MCL scriptable is to give it a Dictionary. The Dictionary is a resource that announces the various AppleEvents and AppleScript constructs that an application support. It also contains mappings from english names to the four-character OS codes used in AppleEvents.You can still send events or script an application even if it doesn't have a dictionary. However, without a dictionary many of the commands in the script will become cryptic instead of containg expressions readable for non-programmers. The file called "aete-for-mcl.rsrc" contains a standard dictionary that specifies the various events and constructs supported by the AE Suites module. To add it to MCL or another application:1. Open the "aete-for-mcl.rsrc" file in ResEdit. 2. Open the application (MCL) in ResEdit.3. Copy the AETE resource.4. Paste it into the resources of the application (MCL).Alternatively create an application-resource-file method for your application with the pathname of the resource file. The resource file will be applied when you save a new application image.Loading the AE SuitesEvaluating the file "ae-suites-sysdecl" loads the complete AE suites module. Note that you aren't required to load all files, as they aren't all depending on each other. You can easily skip the text suite or recordability if either isn't useful for your application.Scripting MCLYou can use Apple's Script Editor that comes with the OS to script MCL with AppleScript. Other OSA scripting systems (such as Frontier) can also be used. You can even write scripts in MCL.The folder called Scripts includes several AppleScripts that demonstrates some of the functionality of the AE Suites.Use Open Dictionary in Apple's Script Editor to inspect the dictonary of the application, as proivded by the AETE resource. The disctionary gives you an overview of available commands and their arguments.Recording a ScriptAfter loading the ae-recordable of the AE Suites, MCL is recordable. For each menu command, MCL sends an AppleEvent to itself, which can be recorded by scripting systems. To record a script:1 Create a new document by choosing New from the File menu in MCL.2. Open Apple's Script Editor.3. Click the Record button in the editor.4. Bring MCL to the front.5. Type in some arbitrary text.6. Choose Select All from the Edit menu.7. Change the font of the text using MCL's font menus.8. Choose Cut from the Edit menu.9. Choose Undo10. Choose Paste11. Save the document.12. Stop the recording by clicking again on the Stop button in the Script Editor.The result is a script. Executing the script on another document leads to a similar result.